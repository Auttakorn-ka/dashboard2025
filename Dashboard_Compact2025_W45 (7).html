
 
<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<title>Dashboard_Summary</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #fff9e6 0%, #f4c086 25%, #ffb347 60%, #ff6b35 100%);
  min-height: 100vh;
  margin: 0;
  padding: 20px;
}
* {
  box-sizing: border-box;
}
h1 {
  font-size: 24px;
  font-weight: 700;
  color: #8b3a00;
  text-shadow: 2px 2px 4px rgba(255,255,255,0.7);
  margin: 20px 0;
  text-align: center;
  padding: 18px 40px;
  background: linear-gradient(135deg, #ffffff 0%, #fff9e6 50%, #ffe4b5 100%);
  border: 4px solid transparent;
  border-radius: 20px;
  background-image: 
    linear-gradient(white, white),
    linear-gradient(135deg, #FFD93D 0%, #FF8C42 50%, #FF6B35 100%);
  background-origin: border-box;
  background-clip: padding-box, border-box;
  box-shadow: 
    0 8px 20px rgba(255,140,66,0.3),
    inset 0 1px 0 rgba(255,255,255,0.8);
  width: calc(100% - 2px);
  position: relative;
  overflow: hidden;
}

h1::before {
  content: '';
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  background: linear-gradient(135deg, #FFD93D, #FF8C42, #FF6B35);
  border-radius: 20px;
  z-index: -1;
  filter: blur(8px);
  opacity: 0.4;
}
.container {
  display: flex;
  gap: 20px;
  margin-top: 10px;
  margin-bottom: 30px;
}
.column {
  flex: 1;
  background: linear-gradient(to bottom, #f0f0ef 1%, #ffffff 100%);
  border-radius: 16px;
  box-shadow: 0 4px 12px rgb(9, 7, 7), 0 1px 3px rgba(255,107,53,0.2);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  border: 1px solid rgba(255, 60, 60, 0.3);
}
.column1 {
  flex: 1;
  background: linear-gradient(to bottom, #e4bc1d 0%, #f9f4f3 100%);
  border-radius: 16px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1), 0 1px 3px rgba(255,107,53,0.2);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  border: 1px solid rgba(0, 0, 0, 0.3);
}

.header {
  background: linear-gradient(135deg, #ffd93d 0%, #ffb347 50%, #ff6b35 100%);
  color: #ffffff;
  font-weight: bold;
  font-size: 18px;
  text-align: center;
  padding: 14px 0;
  text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
  box-shadow: 0 2px 8px rgba(255,107,53,0.3);
}

.header1 {
  background: linear-gradient(135deg,  #ffd941 0%,#f4b029 40%, #49d09c 100%);
  color: #ffffff;
  font-weight: bold;
  font-size: 18px;
  text-align: center;
  padding: 14px 0;
  text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
  box-shadow: 0 2px 8px rgba(255,160,70,0.3);
}

.section {
  padding: 16px 20px;
  border-top: 2px solid #ffb347;
}
.section h3 {
  margin: 0 0 10px 0;
  font-size: 15px;
  font-weight: 600;
  color: #8b3a00;
}
.section1 {
  margin: 0 0 6px 0;
  font-size: 19px;
  font-weight: 700;
  color: #efeeed;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 8px;
  font-size: 13px;
  border-radius: 8px;
  overflow: hidden;
}
th, td {
  padding: 10px 12px;
  border-bottom: 1px solid #ffe4b5;
  text-align: left;
}
th {
  background: linear-gradient(135deg, #ff8c42 0%, #ff6b35 100%);
  color: white;
  text-align: left;
  font-weight: 600;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}

tbody tr:hover {
  background-color: #fff9e6;
  transition: background-color 0.2s ease;
}

tr:last-child td {
  background: linear-gradient(135deg, #fff4d4 0%, #ffe4b5 100%);
  font-weight: bold;
  color: #8b0000;
  border-bottom: none;
}
canvas {
  width: 100% !important;
  height: 90% !important;
  padding: 50 px;
  aspect-ratio: 2 / 1;
  max-height: 250px;
}

}.pie-container {
  width: 50px;       /* ปรับตรงนี้เพื่อย่อ–ขยาย */
  height: 50;
  margin: 20px auto;
  position: relative;
}
/* สีที่อ่านง่ายกว่า บนพื้นหลัง gradient ส้ม-แดง */

/* สำหรับ Task & Bugs */
#summaryTable th:nth-child(2) { color: #0421fd; }  /* Task - เขียวสด */
#summaryTable th:nth-child(3) { color: #ffff00; }  /* Bugs - เหลืองสด */

/* สำหรับ Bug Severity */
#summaryTable1 th:nth-child(2) { color: #1d0202; }     /* Critical - แดงเข้ม */
#summaryTable1 th:nth-child(3) { color: #0421fd; }     /* Major - ส้มเข้ม */
#summaryTable1 th:nth-child(4) { color: #ffff00; }     /* Medium - เหลืองสด */
#summaryTable1 th:nth-child(5) { color: #00ff00; }     /* Minor - เขียวสด */
#summaryTable1 th:nth-child(6) { color: #00ffff; }     /* Comment - ฟ้าสด */
.main-box {
  background: #ffffff;
  border-radius: 20px;
  padding: 20px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.15);
  margin-bottom: 20px;
}

/* ... */
</style>
</head>

<body>
<h1> Task Summary 2025</h1>

<div class="container">
  <!-- Project -->
  <div class="column">
    <div class="header section1">Project</div>
    <div class="section">
      <h3>Summary Project (LastWeek)</h3>
      <table>
        <thead  id="summaryTable"><tr><th>Project</th><th>Task</th><th>Bugs</th><th>Totals</th><th>%Rate</th></tr>
        </thead>
        <tbody id="summaryProjectLast"></tbody>
      </table>
    </div>
    <div class="section"><h3>Monthly</h3><canvas id="chartProjectMonthly"></canvas></div>
    <div class="section"><h3>Weekly</h3><canvas id="chartProjectWeekly"></canvas></div>
    <div class="section"><h3>Progress Task</h3><div class="pie-container"><canvas id="pieProject"></canvas></div></div>
    <div class="section">
      <h3>Task remaining in the project</h3>
      <table>
        <thead><tr><th>Project</th><th>Task</th></tr></thead>
        <tbody id="taskRemainingProject"></tbody>
      </table>
    </div>
  </div>

  <!-- Platform -->
  <div class="column">
    <div class="header1 section1">Platform</div>
    <div class="section">
      <h3>Summary Platform (LastWeek)</h3>
      <table>
        <thead id="summaryTable"><tr><th>Platform</th><th>Task</th><th>Bugs</th><th>Totals</th><th>%Rate</th></tr></thead>
        <tbody id="summaryPlatformLast"></tbody>
      </table>
    </div>
    <div class="section"><h3>Monthly</h3><canvas id="chartPlatformMonthly"></canvas></div>
    <div class="section"><h3>Weekly</h3><canvas id="chartPlatformWeekly"></canvas></div>
    <div class="section"><h3>Progress Task</h3><div class="pie-container"><canvas id="piePlatform"></canvas></div></div>
    <div class="section">
      <h3>Task remaining in the Platform</h3>
      <table>
        <thead><tr><th>Platform</th><th>Task</th></tr></thead>
        <tbody id="taskRemainingPlatform"></tbody>
      </table>
    </div>
  </div>
</div>

<h1> Bugs Summary 2025</h1>

<div class="container">
  <!-- Project -->
  <div class="column">
    <div class="header">Project</div>
    <div class="section">
      <h3>Bug Summary (LastWeek)</h3>
      <table>
        <thead id="summaryTable"><tr><th>Project</th><th>Task</th><th>Bugs</th><th>Totals</th><th>%Rate</th></tr></thead>
        <tbody id="bugProjectTable"></tbody>
      </table>
    </div>
    <div class="section"><h3>Monthly Bugs</h3><canvas id="bugProjectMonthly"></canvas></div>
    <div class="section"><h3>Weekly Bugs</h3><canvas id="bugProjectWeekly"></canvas></div>
    <div class="section"><h3>Progress Bugs</h3><div class="pie-container"><canvas id="bugPieProject"></canvas></div></div>
    <div class="section">
      <h3>Levels of bug severity per project</h3>
      <table>
        <thead id="summaryTable1"><tr><th>Project</th><th>Critical</th><th>Major</th><th>Medium</th><th>Minor</th><th>Comment</th><th>Toltals</th></tr></thead>
        <tbody id="bugSeverityProject"></tbody>
      </table>
    </div>
    <div class="section">
      <h3>Bug remaining in the Project</h3>
      <table>
        <thead><tr><th>Project</th><th>Bugs</th></tr></thead>
        <tbody id="bugRemainingProject"></tbody>
      </table>
    </div>
  </div>

  <!-- Platform -->
  <div class="column">
    <div class="header header1">Platform</div>
    <div class="section">
      <h3>Bug Summary (LastWeek)</h3>
      <table>
        <thead id="summaryTable"><tr><th>Platform</th><th>Task</th><th>Bugs</th><th>Totals</th><th>%Rate</th></tr></thead>
        <tbody id="bugPlatformTable"></tbody>
      </table>
    </div>
    <div class="section"><h3>Monthly Bugs</h3><canvas id="bugPlatformMonthly"></canvas></div>
    <div class="section"><h3>Weekly Bugs</h3><canvas id="bugPlatformWeekly"></canvas></div>
    <div class="section"><h3>Progress Bugs</h3><div class="pie-container"><canvas id="bugPiePlatform"></canvas></div></div>
     <div class="section">
      <h3>Levels of bug severity per Platform</h3>
      <table>
        <thead id="summaryTable1"><tr><th>Platform</th><th>Critical</th><th>Major</th><th>Medium</th><th>Minor</th><th>Comment</th><th>Toltals</th></tr></thead>
        <tbody id="bugSeverityPlatform"></tbody>
      </table>
    </div>
    <div class="section">
      <h3>Bug remaining in the Platform</h3>
      <table>
        <thead><tr><th>Platform</th><th>Bugs</th></tr></thead>
        <tbody id="bugRemainingPlatform"></tbody>
      </table>
    </div>
  </div>
</div>

<h1>Request From Summary 2025</h1>
<div class="main-box">
<div class="container">
 <!-- Request Summary and Level Form Request - Side by Side -->
  <div class="column">
    <div class="header">Form Request</div>
    <div class="section">
      <h3>Request From Summary (LastWeek)</h3>
      <table id="RequestAll"></table>
    </div>
  </div>

  <div class="column">
    <div class="header header1">Level Form Request</div>
    <div class="section">
      <h3>Level Form Request</h3>
      <table>
        <thead id="summaryTable1"><tr><th>Project</th><th>Critical</th><th>Major</th><th>Medium</th><th>Minor</th><th>Comment</th><th>Toltals</th></tr></thead>
        <tbody id="levelFormRequest"></tbody>
      </table>
    </div>
  </div>
</div>

<div class="container">
  <div class="column">
    <div class="header">Monthly</div>
    <div class="section"><canvas id="chartRequestMonthly"></canvas></div>
  </div>

  <div class="column">
    <div class="header header1">Weekly</div>
    <div class="section"><canvas id="chartRequestWeekly"></canvas></div>
  </div>
</div>

<div class="container">
  <div class="column">
    <div class="header header1">Status of Request Weekly</div>
    <div class="section"><div class="pie-container"><canvas id="pieRequestStatus"></canvas></div></div>
  </div>
</div>
</div>







<script>
// ✅ ข้อมูลทั้งหมด
const summaryProjectAll = [{"name":"DITP Website","task":7,"bugs":8,"total":15,"bugRate":"53.3%"},{"name":"DITP - eSurvey","task":7,"bugs":8,"total":15,"bugRate":"53.3%"},{"name":"Motor Expo","task":3,"bugs":1,"total":4,"bugRate":"25.0%"},{"name":"POPMART","task":5,"bugs":0,"total":5,"bugRate":"0.0%"},{"name":"NCC","task":0,"bugs":6,"total":6,"bugRate":"100.0%"},{"name":"CPOT","task":1,"bugs":15,"total":16,"bugRate":"93.8%"},{"name":"ExpoInfo 2025","task":6,"bugs":0,"total":6,"bugRate":"0.0%"},{"name":"Test Project","task":3,"bugs":3,"total":6,"bugRate":"50.0%"},{"name":"Test Project One","task":12,"bugs":1,"total":13,"bugRate":"7.7%"},{"name":"Test Project Two","task":9,"bugs":3,"total":12,"bugRate":"25.0%"}];
const summaryPlatformAll = [{"name":"EMT","task":10,"bugs":11,"total":21,"bugRate":"52.4%"},{"name":"EventMate Application","task":0,"bugs":3,"total":3,"bugRate":"100.0%"},{"name":"EventConnex","task":2,"bugs":0,"total":2,"bugRate":"0.0%"},{"name":"EventConnex Lite","task":8,"bugs":0,"total":8,"bugRate":"0.0%"},{"name":"EventPass Ticket","task":7,"bugs":0,"total":7,"bugRate":"0.0%"},{"name":"EventPass Next","task":9,"bugs":2,"total":11,"bugRate":"18.2%"},{"name":"EventPass Passport","task":2,"bugs":1,"total":3,"bugRate":"33.3%"},{"name":"Test Platform","task":4,"bugs":2,"total":6,"bugRate":"33.3%"},{"name":"Test Platform One","task":9,"bugs":3,"total":12,"bugRate":"25.0%"},{"name":"Test Platform Two","task":12,"bugs":1,"total":13,"bugRate":"7.7%"}];
const taskMonthlyProject = [{"key":"7","value":4},{"key":"9","value":1},{"key":"10","value":24},{"key":"11","value":24}];
const taskWeeklyProject = [{"key":"31","value":4},{"key":"40","value":17},{"key":"41","value":5},{"key":"44","value":3},{"key":"45","value":24}];
const taskMonthlyPlatform = [{"key":"9","value":2},{"key":"10","value":35},{"key":"11","value":26}];
const taskWeeklyPlatform = [{"key":"38","value":2},{"key":"40","value":24},{"key":"41","value":3},{"key":"44","value":8},{"key":"45","value":26}];
const bugMonthlyProject = [{"key":"1","value":5},{"key":"2","value":2},{"key":"5","value":8},{"key":"7","value":1},{"key":"9","value":1},{"key":"10","value":15},{"key":"11","value":13}];
const bugWeeklyProject = [{"key":"5","value":5},{"key":"6","value":2},{"key":"20","value":5},{"key":"22","value":3},{"key":"31","value":1},{"key":"39","value":1},{"key":"40","value":4},{"key":"41","value":8},{"key":"44","value":3},{"key":"45","value":13}];
const bugMonthlyPlatform = [{"key":"6","value":3},{"key":"9","value":3},{"key":"10","value":8},{"key":"11","value":9}];
const bugWeeklyPlatform = [{"key":"24","value":3},{"key":"38","value":3},{"key":"40","value":3},{"key":"44","value":5},{"key":"45","value":9}];
const FilterProjectLatestWeek = [{"name":"ExpoInfo 2025","task":1,"total":1},{"name":"Test Project One","task":3,"total":3},{"name":"Test Project Two","task":4,"total":4}];
const FilterPlatformLatestWeek = [{"name":"EventConnex Lite","task":4,"total":4},{"name":"Test Platform One","task":4,"total":4},{"name":"Test Platform Two","task":3,"total":3}];
const FilterProjectBugLatestWeek = [{"name":"CPOT","bug":2,"total":2},{"name":"Test Project One","bug":1,"total":1},{"name":"Test Project Two","bug":3,"total":3}];
const FilterPlatformBugLatestWeek = [{"name":"EMT","bug":1,"total":1},{"name":"Test Platform One","bug":3,"total":3},{"name":"Test Platform Two","bug":1,"total":1}];
const bugSeverityProject = [{"name":"CPOT","critical":0,"major":2,"medium":1,"minor":0,"comment":0,"total":3},{"name":"DITP Website","critical":1,"major":0,"medium":2,"minor":0,"comment":0,"total":3},{"name":"NCC","critical":1,"major":0,"medium":1,"minor":0,"comment":1,"total":3},{"name":"Test Project One","critical":0,"major":1,"medium":0,"minor":0,"comment":0,"total":1},{"name":"Test Project Two","critical":1,"major":1,"medium":0,"minor":1,"comment":0,"total":3}];
const bugSeverityPlatform = [{"name":"EMT","critical":0,"major":1,"medium":1,"minor":3,"comment":0,"total":5},{"name":"Test Platform One","critical":1,"major":1,"medium":0,"minor":1,"comment":0,"total":3},{"name":"Test Platform Two","critical":0,"major":1,"medium":0,"minor":0,"comment":0,"total":1}];
const summaryRequestEMTThisYear  = [{"name":"New requirement","total":3},{"name":"Issue / Bug","total":3},{"name":"Adjust system","total":1},{"name":"Total","total":7}];
const summaryRequestEVCThisYear  = [{"name":"Issue / Bug","total":7},{"name":"Total","total":7}];
const summaryRequestCPOTThisYear = [{"name":"Issue / Bug","total":6},{"name":"New requirement","total":1},{"name":"Total","total":7}];
const summaryRequestEVPTThisYear = [{"name":"New requirement","total":1},{"name":"Adjust system","total":1},{"name":"Issue / Bug","total":3},{"name":"Other","total":2},{"name":"Total","total":7}];
const summaryRequestDITPThisYear = [{"name":"Comment","total":4},{"name":"Issue / Bug","total":3},{"name":"Total","total":7}];
const requestWeeklyAll = [{"key":"3","value":1},{"key":"5","value":1},{"key":"6","value":1},{"key":"7","value":1},{"key":"8","value":13},{"key":"10","value":2},{"key":"11","value":8},{"key":"12","value":1},{"key":"13","value":1},{"key":"15","value":2},{"key":"17","value":2},{"key":"19","value":4},{"key":"20","value":2},{"key":"21","value":2},{"key":"22","value":5},{"key":"23","value":13},{"key":"24","value":20},{"key":"25","value":35},{"key":"26","value":54},{"key":"27","value":16},{"key":"28","value":5},{"key":"29","value":4},{"key":"30","value":1},{"key":"31","value":5},{"key":"32","value":4},{"key":"33","value":2},{"key":"34","value":4},{"key":"35","value":8},{"key":"37","value":8},{"key":"38","value":11},{"key":"39","value":8},{"key":"40","value":8},{"key":"41","value":3},{"key":"42","value":7},{"key":"45","value":35}];
const requestMonthlyAll = [{"key":"1","value":2},{"key":"2","value":15},{"key":"3","value":12},{"key":"4","value":4},{"key":"5","value":13},{"key":"6","value":128},{"key":"7","value":24},{"key":"8","value":19},{"key":"9","value":32},{"key":"10","value":13},{"key":"11","value":35}];
const summaryRequestAll = [{"name":"New requirement","total":5},{"name":"Issue / Bug","total":22},{"name":"Adjust system","total":2},{"name":"Other","total":2},{"name":"Comment","total":4},{"name":"Total","total":35}];
const RequestAllLatestWeek = [{"row_number":120,"Serial":"TEST01","Project name / Event name":"SOUTHEAST ASIA WOODWORKING SUMMIT 2025 / All Event","วันที่ต้องการใช้งาน":"2025-11-03 11:13","Level of request":"Minor","Menu / Flow ที่ต้องการปรับปรุง":"ปรับให้สามารภกำหนด จนวนคำได้ เช่นจากในฟอร์มต้องการให้ไม่เกิน 150 คำ","รายละเอียดที่ต้องการ":"อยากให้\nShort Text\nLong Text\n>> กำหนดจำนวนคำตัวอักษร และมีการนับคำที่พิมพ์ไป เช่น 0/250 >> 250/250","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"image.png,img_v3_02mo_71cdd5eb-07cc-4620-9b55-46f07229c9hu.jpg","Type of request":"New requirement","Url / Link ที่ใช้งาน (ถ้ามี)":"","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/04 11:00","Submitted Reject":"","Submitted Dev Done":"","Submitted Completed":"","URL Event":"","Dev":"","QA":"","AM":"","Satatus Text":"Completed","Year":"2025","Month":"11","Week":"45","Day":"Tue","Time":"11","Working Hours":"Normal Time","Formula 7":"ตรวจสอบเพิ่มเติม","LastWeek":"45","SubmittedOn_ISO":"2025-11-04T11:00:00.000-05:00","Type":"Request-EMT"},{"row_number":121,"Serial":"TEST02","Project name / Event name":"SOUTHEAST ASIA WOODWORKING SUMMIT 2025 / All Event","วันที่ต้องการใช้งาน":"2025-11-04 11:14","Level of request":"Major","Menu / Flow ที่ต้องการปรับปรุง":"Business matching","รายละเอียดที่ต้องการ":"Business matching เมื่อกด confirm ที่ Request จะขึ้นว่า \nUser does not exist:\nsu.nita_y@hotmail.com.\n(ซึ่ง Email นี้เป็นเมลที่ใช้ล็อกอินเข้า EMT)","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"image.png","Type of request":"Issue / Bug","Url / Link ที่ใช้งาน (ถ้ามี)":"","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/05 11:14","Submitted Reject":"","Submitted Dev Done":"","Submitted Completed":"","URL Event":"","Dev":"","QA":"","AM":"","Satatus Text":"Completed","Year":"2025","Month":"11","Week":"45","Day":"Wed","Time":"11","Working Hours":"Normal Time","Formula 7":"Email","LastWeek":"45","SubmittedOn_ISO":"2025-11-05T11:14:00.000-05:00","Type":"Request-EMT"},{"row_number":122,"Serial":"TEST03","Project name / Event name":"SOUTHEAST ASIA WOODWORKING SUMMIT 2025 / All Event","วันที่ต้องการใช้งาน":"2025-11-05 11:14","Level of request":"Major","Menu / Flow ที่ต้องการปรับปรุง":"รบกวนแก้คำผิดในชื่อไฟล์ของใบเสร็จ จากเดิม Reciept เป็น Receipt เนื่องจากในระบบสะกดผิด","รายละเอียดที่ต้องการ":"รบกวนแก้คำผิดในชื่อไฟล์ของใบเสร็จ จากเดิม Reciept เป็น Receipt เนื่องจากในระบบสะกดผิด","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"image.png","Type of request":"Issue / Bug","Url / Link ที่ใช้งาน (ถ้ามี)":"","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/03 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"","URL Event":"","Dev":"","QA":"","AM":"","Satatus Text":"Completed","Year":"2025","Month":"11","Week":"45","Day":"Mon","Time":"11","Working Hours":"Normal Time","Formula 7":"Document - แก้ไขชื่อไฟล์ / คำผิด","LastWeek":"45","SubmittedOn_ISO":"2025-11-03T11:15:00.000-05:00","Type":"Request-EMT"},{"row_number":123,"Serial":"TEST04","Project name / Event name":"SOUTHEAST ASIA WOODWORKING SUMMIT 2025 / All Event","วันที่ต้องการใช้งาน":"2025-11-06 11:14","Level of request":"Major","Menu / Flow ที่ต้องการปรับปรุง":"ต้องการเพิ่มรายละเอียด เลขที่อ้างอิงการชําระ/ Payment Ref No. (เป็นเลขอ้างอิงการชำระเงินจากทาง GBP  (อ้างอิงตามภาพแนบ) ","รายละเอียดที่ต้องการ":"ต้องการเพิ่มรายละเอียด เลขที่อ้างอิงการชําระ/ Payment Ref No. (เป็นเลขอ้างอิงการชำระเงินจากทาง GBP  (อ้างอิงตามภาพแนบ) ","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"img_v3_02mb_7591e8fe-f0a9-43c9-83d8-70a2f25a06hu.jpg","Type of request":"New requirement","Url / Link ที่ใช้งาน (ถ้ามี)":"","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/06 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"","URL Event":"","Dev":"","QA":"","AM":"","Satatus Text":"Cancel","Year":"2025","Month":"11","Week":"45","Day":"Thu","Time":"11","Working Hours":"Normal Time","Formula 7":"Payment","LastWeek":"45","SubmittedOn_ISO":"2025-11-06T11:15:00.000-05:00","Type":"Request-EMT"},{"row_number":124,"Serial":"TEST05","Project name / Event name":"SOUTHEAST ASIA WOODWORKING SUMMIT 2025 / All Event","วันที่ต้องการใช้งาน":"2025-11-06 11:14","Level of request":"Major","Menu / Flow ที่ต้องการปรับปรุง":"Receipt .pdf","รายละเอียดที่ต้องการ":"ต้องการเพิ่มรายละเอียดช่องทางการชำระ ช่องทางการชำระ / Payment method (อ้างอิงตามภาพแนบ)\n\nโดยระบุช่องทาง เช่น Credit card, QR Code","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"img_v3_02m2_5bb99462-7692-46ad-bcba-4c7a2fc82a7h.jpg","Type of request":"Adjust system","Url / Link ที่ใช้งาน (ถ้ามี)":"","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/07 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"","URL Event":"","Dev":"","QA":"","AM":"","Satatus Text":"Dev Done","Year":"2025","Month":"11","Week":"45","Day":"Fri","Time":"11","Working Hours":"Normal Time","Formula 7":"Payment","LastWeek":"45","SubmittedOn_ISO":"2025-11-07T11:15:00.000-05:00","Type":"Request-EMT"},{"row_number":125,"Serial":"TEST06","Project name / Event name":"SOUTHEAST ASIA WOODWORKING SUMMIT 2025 / All Event","วันที่ต้องการใช้งาน":"2025-11-06 11:14","Level of request":"Major","Menu / Flow ที่ต้องการปรับปรุง":"report form&questionnaire","รายละเอียดที่ต้องการ":"export excel form / questionnaire กรณี field multiple choice เลือก > 1 ข้อมูลแสดงไม่ถูกต้อง","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"20250506-104048.jpeg,20250506-103943.jpeg","Type of request":"Issue / Bug","Url / Link ที่ใช้งาน (ถ้ามี)":"","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/06 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"2025/05/06 18:37","URL Event":"","Dev":"","QA":"","AM":"","Satatus Text":"Dev Done","Year":"2025","Month":"11","Week":"45","Day":"Thu","Time":"11","Working Hours":"Normal Time","Formula 7":"Form / Registration","LastWeek":"45","SubmittedOn_ISO":"2025-11-06T11:15:00.000-05:00","Type":"Request-EMT"},{"row_number":126,"Serial":"TEST07","Project name / Event name":"SOUTHEAST ASIA WOODWORKING SUMMIT 2025 / All Event","วันที่ต้องการใช้งาน":"2025-11-07 11:14","Level of request":"Minor","Menu / Flow ที่ต้องการปรับปรุง":"Visitor > Change Ticket & Form Registration","รายละเอียดที่ต้องการ":"เพิ่มการ เปิด/ปิดไม่ให้ Change Ticket & Form Registration ของแต่ละ Role ตามที่ต้องการ เช่น Role Organizer report หรือ Admin แก้ไขไม่ได้ \n\nเหมือนการตั้ง Role config ในส่วนของการเปิดปิด การ Action","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"image.png,image.png","Type of request":"New requirement","Url / Link ที่ใช้งาน (ถ้ามี)":"","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/05 11:15","Submitted Reject":"","Submitted Dev Done":"","Submitted Completed":"","URL Event":"","Dev":"","QA":"","AM":"","Satatus Text":"Dev Done","Year":"2025","Month":"11","Week":"45","Day":"Wed","Time":"11","Working Hours":"Normal Time","Formula 7":"Visitor","LastWeek":"45","SubmittedOn_ISO":"2025-11-05T11:15:00.000-05:00","Type":"Request-EMT"},{"row_number":72,"Serial":"TEST01","Project Name":"EventConnex - App","Requirement":"A Must Urgent","Event name":"ONE PRIDE, ONE RUN","Event Code":"ปรับให้สามารภกำหนด จนวนคำได้ เช่นจากในฟอร์มต้องการให้ไม่เกิน 150 คำ","วันที่ต้องการใช้งาน":"2025-11-03 11:13","Level of request":"Major","Menu / Flow ที่ต้องการปรับปรุง":"New requirement","รายละเอียดที่ต้องการ":"ลงทะเบียนจาก Broadcast invite เลือกคำตอบจาก multiple choice กดปุ่ม Submit ระบบแจ้งเตือน Answer เข้าร่วมประกวดชุดสุดปังในงาน One Pride, One Run ด้วยหรือไม่ not empty.","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"mulitple-choice.mp4","Type of request":"Issue / Bug","Url / Link ที่ใช้งาน (ถ้ามี)":"","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/04 11:00","Submitted Reject":"","Submitted Dev Done":"","Submitted Completed":"","QA":"","Year":"2025","Month":"11","Week":"45","Day":"Tue","Time":"11","Working Hours":"Normal Time","Satatus Text":"Normal Time","Impact Analytic":"ตรวจสอบเพิ่มเติม","Version":"45","SOW_FuncNo":"","Formula 7":"Email","LastWeek":"45","SubmittedOn_ISO":"2025-11-04T11:00:00.000-05:00","Type":"Request-EVC"},{"row_number":73,"Serial":"TEST04","Project Name":"SOUTHEAST ASIA WOODWORKING SUMMIT 2025 / All Event","Requirement":"Nice To Have","Event name":"All","Event Code":"ต้องการเพิ่มรายละเอียด เลขที่อ้างอิงการชําระ/ Payment Ref No. (เป็นเลขอ้างอิงการชำระเงินจากทาง GBP  (อ้างอิงตามภาพแนบ) ","วันที่ต้องการใช้งาน":"2025-11-06 11:14","Level of request":"Major","Menu / Flow ที่ต้องการปรับปรุง":"New requirement","รายละเอียดที่ต้องการ":"Alert Checkin : alert message หลังจาก check in ขึ้น undefine ให้แสดงเป็นค่าว่าง","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"image.png","Type of request":"Issue / Bug","Url / Link ที่ใช้งาน (ถ้ามี)":"","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/06 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"","QA":"","Year":"2025","Month":"11","Week":"45","Day":"Thu","Time":"11","Working Hours":"Normal Time","Satatus Text":"Normal Time","Impact Analytic":"Payment","Version":"45","SOW_FuncNo":"","Formula 7":"Scan / Handheld","LastWeek":"45","SubmittedOn_ISO":"2025-11-06T11:15:00.000-05:00","Type":"Request-EVC"},{"row_number":74,"Serial":"TEST05","Project Name":"SOUTHEAST ASIA WOODWORKING SUMMIT 2025 / All Event","Requirement":"A Must","Event name":"Professional Exhibition Management (PEM) : Project Manager","Event Code":"Receipt .pdf","วันที่ต้องการใช้งาน":"2025-11-06 11:14","Level of request":"Major","Menu / Flow ที่ต้องการปรับปรุง":"Adjust system","รายละเอียดที่ต้องการ":"ดึงสถานะ Success ของ Transaction ID : ref7ptjJekfX2JJ และ refhOPenOMdeoaO ลงทะเบียนมาเมื่อ 30/07/2025 ","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"image.png","Type of request":"Issue / Bug","Url / Link ที่ใช้งาน (ถ้ามี)":"https://eventconnex.co/organizers/65daf09525c5150013403407/events/68770b379fa5850011578b03/manage/event-setting/payment/payment-list","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/07 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"","QA":"","Year":"2025","Month":"11","Week":"45","Day":"Fri","Time":"11","Working Hours":"Normal Time","Satatus Text":"Normal Time","Impact Analytic":"Payment","Version":"45","SOW_FuncNo":"","Formula 7":"อื่น ๆ","LastWeek":"45","SubmittedOn_ISO":"2025-11-07T11:15:00.000-05:00","Type":"Request-EVC"},{"row_number":75,"Serial":"TEST06","Project Name":"EventConnex - Web","Requirement":"A Must","Event name":"SANDBOX by TEA | Press Start Event Application Form","Event Code":"report form&questionnaire","วันที่ต้องการใช้งาน":"2025-11-06 11:14","Level of request":"Major","Menu / Flow ที่ต้องการปรับปรุง":"Issue / Bug","รายละเอียดที่ต้องการ":"ข้อมูล Waiting Upload Slip และ Waiting For Approval ไม่แสดง ทั้ง ๆ ที่ใน Payment List มีข้อมูลที่เป็นสถานะ Waiting Upload Slip และ Waiting For Approval อยู่","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"img_v3_02q2_73a8f1c3-9559-41b1-a214-5fc6c34d8ahu.jpg","Type of request":"Issue / Bug","Url / Link ที่ใช้งาน (ถ้ามี)":"https://eventconnex.co/organizers/65daf09525c5150013403407/events/68b93b6c41d06c0013917aa0/manage/event-setting/payment/payment-list","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/06 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"2025/05/06 18:37","QA":"","Year":"2025","Month":"11","Week":"45","Day":"Thu","Time":"11","Working Hours":"Normal Time","Satatus Text":"Normal Time","Impact Analytic":"Form / Registration","Version":"45","SOW_FuncNo":"","Formula 7":"Payment / Ticket","LastWeek":"45","SubmittedOn_ISO":"2025-11-06T11:15:00.000-05:00","Type":"Request-EVC"},{"row_number":76,"Serial":"TEST07","Project Name":"EventConnex - Web","Requirement":"","Event name":"All Event","Event Code":"Visitor > Change Ticket & Form Registration","วันที่ต้องการใช้งาน":"2025-11-07 11:14","Level of request":"Major","Menu / Flow ที่ต้องการปรับปรุง":"New requirement","รายละเอียดที่ต้องการ":"Edit Attendee : กรณี question มี sub question กลับไม่แสดงข้อมูล answer sub question ออกมา","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"img_v3_02qj_adbe49f7-3a24-4a92-9e0f-6fcd78963dhu.jpg,img_v3_02qj_9ce16ae9-bf56-4de4-8c39-5a18fab6b5hu.jpg","Type of request":"Issue / Bug","Url / Link ที่ใช้งาน (ถ้ามี)":"https://eventconnex.co/organizers/65b35d9b24ca790013b4c94a/events/68db444b1307ba001200f8c0/manage/event-setting/registration?page=Form&tab=form&formID=68db444d1307ba0012012965&registerConfigID=68db444d1307ba001201295e&languageID=62148cd251086e9be70250d4","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/05 11:15","Submitted Reject":"","Submitted Dev Done":"","Submitted Completed":"","QA":"","Year":"2025","Month":"11","Week":"45","Day":"Wed","Time":"11","Working Hours":"Normal Time","Satatus Text":"Normal Time","Impact Analytic":"Visitor","Version":"45","SOW_FuncNo":"","Formula 7":"อื่น ๆ","LastWeek":"45","SubmittedOn_ISO":"2025-11-05T11:15:00.000-05:00","Type":"Request-EVC"},{"row_number":77,"Serial":"TEST02","Project Name":"EventConnex - App","Requirement":"A Must Urgent","Event name":"All Event","Event Code":"Business matching","วันที่ต้องการใช้งาน":"2025-11-04 11:14","Level of request":"Minor","Menu / Flow ที่ต้องการปรับปรุง":"Issue / Bug","รายละเอียดที่ต้องการ":"Attendee list : ไฟล์ export ข้อมุลคอลัมน์ Register Date,Register Time[ฟ้า] แสดงเวลาของลงทะเบียนไม่ถูกต้อง กรณีลงผ่านด้วย Broadcast","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"image.png","Type of request":"Issue / Bug","Url / Link ที่ใช้งาน (ถ้ามี)":"cms : https://insight-x-cms-uat.eventpass.biz/organizers/662a3727c69b8f0012c5f32b/events/6823011b7a9b8400125a59a8/manage/event-setting/attendees\naccount : praepilai.pi@gmail.com / *Praepilai26","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/05 11:14","Submitted Reject":"","Submitted Dev Done":"","Submitted Completed":"","QA":"","Year":"2025","Month":"11","Week":"45","Day":"Wed","Time":"11","Working Hours":"Normal Time","Satatus Text":"Normal Time","Impact Analytic":"Email","Version":"45","SOW_FuncNo":"","Formula 7":"Event Info - Date / Time","LastWeek":"45","SubmittedOn_ISO":"2025-11-05T11:14:00.000-05:00","Type":"Request-EVC"},{"row_number":78,"Serial":"TEST03","Project Name":"EventConnex - App","Requirement":"A Must Urgent","Event name":"ทุก Event","Event Code":"รบกวนแก้คำผิดในชื่อไฟล์ของใบเสร็จ จากเดิม Reciept เป็น Receipt เนื่องจากในระบบสะกดผิด","วันที่ต้องการใช้งาน":"2025-11-05 11:14","Level of request":"Minor","Menu / Flow ที่ต้องการปรับปรุง":"Issue / Bug","รายละเอียดที่ต้องการ":"ตอนนี้ไม่สามารถสร้าง Attendee Type ได้ ต้องการให้สร้าง Attendee Type ได้","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"image.png","Type of request":"Issue / Bug","Url / Link ที่ใช้งาน (ถ้ามี)":"","FYI":"","Remark":"","Respondents":"","Submitted on":"2025/11/03 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"","QA":"","Year":"2025","Month":"11","Week":"45","Day":"Mon","Time":"11","Working Hours":"Normal Time","Satatus Text":"Normal Time","Impact Analytic":"Document - แก้ไขชื่อไฟล์ / คำผิด","Version":"45","SOW_FuncNo":"","Formula 7":"Event Setting","LastWeek":"45","SubmittedOn_ISO":"2025-11-03T11:15:00.000-05:00","Type":"Request-EVC"},{"row_number":21,"Text":"TEST01","Single Option":"ระบบการจัดการร้านค้า","Type of request":"Issue / Bug","Level of request":"Comment","Menu / Flow ที่ต้องการปรับปรุง":"เข้าใช้งานระบบ","รายละเอียดที่ต้องการ":"เข้าใช้งานระบบไม่ได้","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"","Url / Link ที่ใช้งาน (ถ้ามี)":"","Image2":"","Remark":"","Respondents":"","Submitted on":"2025/11/04 11:00","Submitted Reject":"","Submitted Dev Done":"","Submitted Completed":"","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","หน่วยงานที่แจ้ง":"ชุมชน","ชื่อผู้แจ้งเคส":"เสาวลักษณ์ สืบสมาน","อีเมลติดต่อกลับ":"seubsamarnsaowalak@gmail.com","เบอร์ติดต่อกลับ":"0818318954","TaskDesc":"","State":"Incident","Sprint":"Prod","Satatus Text":"Completed","Year":"2025","Month":"11","Week":"45","Day":"Tue","Time":"11","Working Hours":"Normal Time","Formula 8":"Login","LastWeek":"45","SubmittedOn_ISO":"2025-11-04T11:00:00.000-05:00","Type":"Request-CPOT"},{"row_number":22,"Text":"TEST03","Single Option":"ระบบการจัดการร้านค้า","Type of request":"Issue / Bug","Level of request":"Comment","Menu / Flow ที่ต้องการปรับปรุง":"เข้าใช้งานระบบ","รายละเอียดที่ต้องการ":"การที่เราสมัครเข้าสู่ร้านค้า กรอกemail  เบอร์โทรศัพ  รหัสotp เลขบัตร ปชช แล้ว ทำไมยังหมุนอยู่นานมากๆ","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"","Url / Link ที่ใช้งาน (ถ้ามี)":"","Image2":"","Remark":"","Respondents":"","Submitted on":"2025/11/03 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","หน่วยงานที่แจ้ง":"ชุมชน","ชื่อผู้แจ้งเคส":"คุณ Mink","อีเมลติดต่อกลับ":"","เบอร์ติดต่อกลับ":"-","TaskDesc":"","State":"Incident","Sprint":"Prod","Satatus Text":"Completed","Year":"2025","Month":"11","Week":"45","Day":"Mon","Time":"11","Working Hours":"Normal Time","Formula 8":"Account","LastWeek":"45","SubmittedOn_ISO":"2025-11-03T11:15:00.000-05:00","Type":"Request-CPOT"},{"row_number":23,"Text":"TEST05","Single Option":"ระบบเว็บไซต์ CPOTSHOP.COM","Type of request":"Issue / Bug","Level of request":"Comment","Menu / Flow ที่ต้องการปรับปรุง":"ไม่สามารถเข้าใช้งานเว็บไซต์ได้","รายละเอียดที่ต้องการ":"แก้ไขไม่สามารถเข้าใช้งานเว็บไซต์ได้","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"image.png","Url / Link ที่ใช้งาน (ถ้ามี)":"https://www.cpotshop.com/","Image2":"","Remark":"","Respondents":"","Submitted on":"2025/11/07 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","หน่วยงานที่แจ้ง":"กระทรวงวัฒนธรรม","ชื่อผู้แจ้งเคส":"Man Tanawat","อีเมลติดต่อกลับ":"tanawat@eventthai.com","เบอร์ติดต่อกลับ":"0891750845","TaskDesc":"","State":"Incident","Sprint":"Prod","Satatus Text":"Completed","Year":"2025","Month":"11","Week":"45","Day":"Fri","Time":"11","Working Hours":"Normal Time","Formula 8":"Web","LastWeek":"45","SubmittedOn_ISO":"2025-11-07T11:15:00.000-05:00","Type":"Request-CPOT"},{"row_number":24,"Text":"TEST06","Single Option":"ระบบเว็บไซต์ CPOTSHOP.COM","Type of request":"Issue / Bug","Level of request":"Major","Menu / Flow ที่ต้องการปรับปรุง":"ไม่สามารถใช้คูปองได้","รายละเอียดที่ต้องการ":"ไม่สามารถใช้คูปองได้ หากใช้งานได้แล้วโปรดติดต่อกลับมาที่เบอร์ 097-2566606 และสอนการใช้งานคูปอง","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"image.png","Url / Link ที่ใช้งาน (ถ้ามี)":"","Image2":"","Remark":"","Respondents":"","Submitted on":"2025/11/06 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"2025/05/06 18:37","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","หน่วยงานที่แจ้ง":"ชุมชน","ชื่อผู้แจ้งเคส":"NUT songchai (แจ้งแทน)","อีเมลติดต่อกลับ":"","เบอร์ติดต่อกลับ":"097-2566606","TaskDesc":"","State":"","Sprint":"Prod","Satatus Text":"Dev Done","Year":"2025","Month":"11","Week":"45","Day":"Thu","Time":"11","Working Hours":"Normal Time","Formula 8":"Coupon","LastWeek":"45","SubmittedOn_ISO":"2025-11-06T11:15:00.000-05:00","Type":"Request-CPOT"},{"row_number":25,"Text":"TEST07","Single Option":"ระบบการจัดการร้านค้า","Type of request":"New requirement","Level of request":"Major","Menu / Flow ที่ต้องการปรับปรุง":"Shop management จัดการบัญชีธนาคารของร้านค้า","รายละเอียดที่ต้องการ":"ต้องการเพิ่มการจัดการบัญชีธนาคารของร้านค้า","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"","Url / Link ที่ใช้งาน (ถ้ามี)":"https://shop.cpotshop.com/","Image2":"","Remark":"","Respondents":"","Submitted on":"2025/11/05 11:15","Submitted Reject":"","Submitted Dev Done":"","Submitted Completed":"","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","หน่วยงานที่แจ้ง":"ชุมชน","ชื่อผู้แจ้งเคส":"Admin Eventthai","อีเมลติดต่อกลับ":"","เบอร์ติดต่อกลับ":"0891750845","TaskDesc":"","State":"","Sprint":"Prod","Satatus Text":"Todo","Year":"2025","Month":"11","Week":"45","Day":"Wed","Time":"11","Working Hours":"Normal Time","Formula 8":"Other - เคสพิเศษ (ควรจัดหมวดแยกเพิ่ม)","LastWeek":"45","SubmittedOn_ISO":"2025-11-05T11:15:00.000-05:00","Type":"Request-CPOT"},{"row_number":26,"Text":"TEST02","Single Option":"ระบบการจัดการร้านค้า","Type of request":"Issue / Bug","Level of request":"Medium","Menu / Flow ที่ต้องการปรับปรุง":"สอบถามการกำหนดรหัสสินค้า","รายละเอียดที่ต้องการ":"สอบถามการกำหนดรหัสสินค้า","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"","Url / Link ที่ใช้งาน (ถ้ามี)":"","Image2":"","Remark":"","Respondents":"","Submitted on":"2025/11/05 11:14","Submitted Reject":"","Submitted Dev Done":"","Submitted Completed":"","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","หน่วยงานที่แจ้ง":"ชุมชน","ชื่อผู้แจ้งเคส":"คุณเปิ้ล","อีเมลติดต่อกลับ":"","เบอร์ติดต่อกลับ":"-","TaskDesc":"","State":"Incident","Sprint":"Prod","Satatus Text":"On Process","Year":"2025","Month":"11","Week":"45","Day":"Wed","Time":"11","Working Hours":"Normal Time","Formula 8":"Product","LastWeek":"45","SubmittedOn_ISO":"2025-11-05T11:14:00.000-05:00","Type":"Request-CPOT"},{"row_number":27,"Text":"TEST04","Single Option":"ระบบการจัดการร้านค้า","Type of request":"Issue / Bug","Level of request":"Minor","Menu / Flow ที่ต้องการปรับปรุง":"ต้องการเปลี่ยน Email สำหรับติดต่อและเข้าใช้งานระบบ","รายละเอียดที่ต้องการ":"ต้องการเปลี่ยน Email สำหรับติดต่อและเข้าใช้งานระบบ\nข้อมูลเดิม\nร้านค้า : แก้วประดิษฐ์ & แฮนด์เมด\nEmail : mink1970.s@gmail.com\nTel. : 0914811054\n\nข้อมูลที่ต้องการเปลี่ยน\nEmail : minkgreen1970@gmail.com","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"","Url / Link ที่ใช้งาน (ถ้ามี)":"","Image2":"","Remark":"","Respondents":"","Submitted on":"2025/11/06 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","หน่วยงานที่แจ้ง":"ชุมชน","ชื่อผู้แจ้งเคส":"K'Mink","อีเมลติดต่อกลับ":"","เบอร์ติดต่อกลับ":"0914811054","TaskDesc":"","State":"Incident","Sprint":"Prod","Satatus Text":"On Process","Year":"2025","Month":"11","Week":"45","Day":"Thu","Time":"11","Working Hours":"Normal Time","Formula 8":"Email","LastWeek":"45","SubmittedOn_ISO":"2025-11-06T11:15:00.000-05:00","Type":"Request-CPOT"},{"row_number":105,"Serial":"TEST02","Project name / Event name":"มโหฬารงานแคมป์ 2 ตอน แคมป์ | กลาง | กรุงฯ","วันที่ต้องการใช้งาน":"2025-11-07 11:22","Level of request":"Major","Type of request":"New requirement","Submitted on":"2025/11/05 11:14","Year":"2025","Month":"11","Week":"45","Day":"Wed","Time":"11","Working Hours":"Normal Time","Satatus Text":"Completed","รายละเอียดที่ต้องการ":"ข้อมูลที่ถูกต้องของลูกค้า\nหนึ่งฤทัย สุขประเสริฐ \n0953303427\nStd.63122010150@ubru.ac.th","Formula 7":"อื่น ๆ","LastWeek":"45","SubmittedOn_ISO":"2025-11-05T11:14:00.000-05:00","Type":"Request-EVPT"},{"row_number":106,"Serial":"TEST04","Project name / Event name":"Motor Expo 2024","วันที่ต้องการใช้งาน":"2025-11-07 11:22","Level of request":"Major","Type of request":"Adjust system","Submitted on":"2025/11/06 11:15","Year":"2025","Month":"11","Week":"45","Day":"Thu","Time":"11","Working Hours":"Normal Time","Satatus Text":"Completed","รายละเอียดที่ต้องการ":"ข้อมูลลลูกค้าครับ\nนภัสวรรณ แก้วมณี\n0946426635","Formula 7":"อื่น ๆ","LastWeek":"45","SubmittedOn_ISO":"2025-11-06T11:15:00.000-05:00","Type":"Request-EVPT"},{"row_number":107,"Serial":"TEST05","Project name / Event name":"Motor Expo 2024","วันที่ต้องการใช้งาน":"2025-11-07 11:22","Level of request":"Major","Type of request":"Issue / Bug","Submitted on":"2025/11/07 11:15","Year":"2025","Month":"11","Week":"45","Day":"Fri","Time":"11","Working Hours":"Normal Time","Satatus Text":"Completed","รายละเอียดที่ต้องการ":"ปรับปุ่มซื้อ Main Ticket เป็น Book Now","Formula 7":"อื่น ๆ","LastWeek":"45","SubmittedOn_ISO":"2025-11-07T11:15:00.000-05:00","Type":"Request-EVPT"},{"row_number":108,"Serial":"TEST06","Project name / Event name":"PAUSE BACK TO LIFE","วันที่ต้องการใช้งาน":"2025-11-07 11:22","Level of request":"Major","Type of request":"Issue / Bug","Submitted on":"2025/11/06 11:15","Year":"2025","Month":"11","Week":"45","Day":"Thu","Time":"11","Working Hours":"Normal Time","Satatus Text":"Completed","รายละเอียดที่ต้องการ":"Set Up Fill Form แล้วแต่พอกดซื้อแล้วข้ามไปหน้าจ่ายเงินเลยค่ะ","Formula 7":"อื่น ๆ","LastWeek":"45","SubmittedOn_ISO":"2025-11-06T11:15:00.000-05:00","Type":"Request-EVPT"},{"row_number":109,"Serial":"TEST01","Project name / Event name":"อีสานใต้มิวสิคเฟส","วันที่ต้องการใช้งาน":"2025-11-07 11:22","Level of request":"Minor","Type of request":"Other","Submitted on":"2025/11/04 11:00","Year":"2025","Month":"11","Week":"45","Day":"Tue","Time":"11","Working Hours":"Normal Time","Satatus Text":"Completed","รายละเอียดที่ต้องการ":"ขอ export ไฟล์รายชื่อ - วันเกิดคนที่กดจองงานภูวินทร์ ผู้จัดจะขอดูว่ามีคนเกิดวันที่ 29 มิถุนายน ร่วมงานไหม","Formula 7":"อื่น ๆ","LastWeek":"45","SubmittedOn_ISO":"2025-11-04T11:00:00.000-05:00","Type":"Request-EVPT"},{"row_number":110,"Serial":"TEST03","Project name / Event name":"SOMTHIP MUSIC FESTIVAL #2.1","วันที่ต้องการใช้งาน":"2025-11-07 11:22","Level of request":"Minor","Type of request":"Issue / Bug","Submitted on":"2025/11/03 11:15","Year":"2025","Month":"11","Week":"45","Day":"Mon","Time":"11","Working Hours":"Normal Time","Satatus Text":"Completed","รายละเอียดที่ต้องการ":"เพิ่มบัตร VIP ที่เลือกไซส์เสื้อได้ขนาดตามไฟล์แนบครับ","Formula 7":"อื่น ๆ","LastWeek":"45","SubmittedOn_ISO":"2025-11-03T11:15:00.000-05:00","Type":"Request-EVPT"},{"row_number":111,"Serial":"TEST07","Project name / Event name":"ส่ง SMS remind QR CODE somthip music festival 2.1","วันที่ต้องการใช้งาน":"2025-11-07 11:22","Level of request":"Minor","Type of request":"Other","Submitted on":"2025/11/05 11:15","Year":"2025","Month":"11","Week":"45","Day":"Wed","Time":"11","Working Hours":"Normal Time","Satatus Text":"Completed","รายละเอียดที่ต้องการ":"Export Ticket Registered List ของงาน Pause ตั้งแต่เปิดงานไม่ได้ ระบบแสดงแค่วันสุดท้ายครับ","Formula 7":"อื่น ๆ","LastWeek":"45","SubmittedOn_ISO":"2025-11-05T11:15:00.000-05:00","Type":"Request-EVPT"},{"row_number":102,"Serial":"TEST01","ระบบ":"MA Website DITP 68","ประเภทการแจ้ง":"Comment","ความรุนแรงของปัญหา":"Medium","Menu / Flow ที่ต้องการปรับปรุง":"","รายละเอียดที่ต้องการ":"CMS : ข่าวประชาสัมพันธ์กรม : เพิ่มฟิลด์อัพโหลดไฟล์ PDF","Note":"","Assign":"BU3","Due date":"07/11/2025","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"","Url / Link ที่ใช้งาน (ถ้ามี)":"","Respondents":"","Submitted on":"2025/11/04 11:00","Submitted Reject":"","Submitted Dev Done":"","Submitted Completed":"","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","ชื่อผู้แจ้งเคส":"","อีเมลติดต่อกลับ":"","เบอร์ติดต่อกลับ":"","Sprint":"","Satatus Text":"Completed","Week":"45","Time":"11","Working Hours":"Normal Time","Month":"11","Formula":"Export / Report","Develop By":"","Fixbug":"","Remark":"","LastWeek":"45","Year":"2025","SubmittedOn_ISO":"2025-11-04T11:00:00.000-05:00","Type":"Request-DITP"},{"row_number":103,"Serial":"TEST05","ระบบ":"MA Website DITP 68","ประเภทการแจ้ง":"Comment","ความรุนแรงของปัญหา":"Minor","Menu / Flow ที่ต้องการปรับปรุง":"","รายละเอียดที่ต้องการ":"WEB : เพิ่ม เมนูbar ด้านบน ในส่วนของหัวข้อ คู่มือการทำการค้าระหว่างประเทศ\nเพิ่มหัวข้อ \n-นิตยสารออนไลน์ด้านการค้า \n-คู่มือด้านการค้า","Note":"","Assign":"BU3","Due date":"03/11/2025","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"","Url / Link ที่ใช้งาน (ถ้ามี)":"","Respondents":"","Submitted on":"2025/11/07 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","ชื่อผู้แจ้งเคส":"","อีเมลติดต่อกลับ":"","เบอร์ติดต่อกลับ":"","Sprint":"","Satatus Text":"Completed","Week":"45","Time":"11","Working Hours":"Normal Time","Month":"11","Formula":"Web Related","Develop By":"","Fixbug":"","Remark":"","LastWeek":"45","Year":"2025","SubmittedOn_ISO":"2025-11-07T11:15:00.000-05:00","Type":"Request-DITP"},{"row_number":104,"Serial":"TEST03","ระบบ":"MA Website DITP 68","ประเภทการแจ้ง":"Comment","ความรุนแรงของปัญหา":"Minor","Menu / Flow ที่ต้องการปรับปรุง":"","รายละเอียดที่ต้องการ":"CMS : create date ที่สามารถเป็น default ได้ ","Note":"","Assign":"BU3","Due date":"04/11/2025","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"","Url / Link ที่ใช้งาน (ถ้ามี)":"","Respondents":"","Submitted on":"2025/11/03 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","ชื่อผู้แจ้งเคส":"","อีเมลติดต่อกลับ":"","เบอร์ติดต่อกลับ":"","Sprint":"","Satatus Text":"Dev Done","Week":"45","Time":"11","Working Hours":"Normal Time","Month":"11","Formula":"อื่น ๆ","Develop By":"","Fixbug":"","Remark":"","LastWeek":"45","Year":"2025","SubmittedOn_ISO":"2025-11-03T11:15:00.000-05:00","Type":"Request-DITP"},{"row_number":105,"Serial":"TEST04","ระบบ":"MA Website DITP 68","ประเภทการแจ้ง":"Comment","ความรุนแรงของปัญหา":"Minor","Menu / Flow ที่ต้องการปรับปรุง":"","รายละเอียดที่ต้องการ":"WEB : Footer :  เปลี่ยน logo ใหม่","Note":"","Assign":"BU3","Due date":"06/11/2025","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"","Url / Link ที่ใช้งาน (ถ้ามี)":"","Respondents":"","Submitted on":"2025/11/06 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","ชื่อผู้แจ้งเคส":"","อีเมลติดต่อกลับ":"","เบอร์ติดต่อกลับ":"","Sprint":"","Satatus Text":"Dev Done","Week":"45","Time":"11","Working Hours":"Normal Time","Month":"11","Formula":"Web Related","Develop By":"","Fixbug":"","Remark":"","LastWeek":"45","Year":"2025","SubmittedOn_ISO":"2025-11-06T11:15:00.000-05:00","Type":"Request-DITP"},{"row_number":106,"Serial":"TEST02","ระบบ":"MA Website DITP 68","ประเภทการแจ้ง":"Issue / Bug","ความรุนแรงของปัญหา":"Medium","Menu / Flow ที่ต้องการปรับปรุง":"","รายละเอียดที่ต้องการ":"เรื่อง api ditp one ","Note":"","Assign":"BU3","Due date":"07/11/2025","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"","Url / Link ที่ใช้งาน (ถ้ามี)":"","Respondents":"","Submitted on":"2025/11/05 11:14","Submitted Reject":"","Submitted Dev Done":"","Submitted Completed":"","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","ชื่อผู้แจ้งเคส":"","อีเมลติดต่อกลับ":"","เบอร์ติดต่อกลับ":"","Sprint":"","Satatus Text":"Dev Done","Week":"45","Time":"11","Working Hours":"Normal Time","Month":"11","Formula":"API","Develop By":"","Fixbug":"","Remark":"","LastWeek":"45","Year":"2025","SubmittedOn_ISO":"2025-11-05T11:14:00.000-05:00","Type":"Request-DITP"},{"row_number":107,"Serial":"TEST06","ระบบ":"Trade Registration","ประเภทการแจ้ง":"Issue / Bug","ความรุนแรงของปัญหา":"Major","Menu / Flow ที่ต้องการปรับปรุง":"- ","รายละเอียดที่ต้องการ":"เคยเป็น Member visitor มาก่อน แล้วเอาอีเมลเดิมมาทำการสร้างเป็น Admin ระบบไม่สามารถสร้างได้","Note":"","Assign":"BU3","Due date":"03/11/2025","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"","Url / Link ที่ใช้งาน (ถ้ามี)":"","Respondents":"","Submitted on":"2025/11/06 11:15","Submitted Reject":"","Submitted Dev Done":"2025/06/13 19:48","Submitted Completed":"2025/05/06 18:37","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","ชื่อผู้แจ้งเคส":"","อีเมลติดต่อกลับ":"","เบอร์ติดต่อกลับ":"","Sprint":"","Satatus Text":"Dev Done","Week":"45","Time":"11","Working Hours":"Normal Time","Month":"11","Formula":"Email / Password / Registered","Develop By":"","Fixbug":"","Remark":"","LastWeek":"45","Year":"2025","SubmittedOn_ISO":"2025-11-06T11:15:00.000-05:00","Type":"Request-DITP"},{"row_number":108,"Serial":"TEST07","ระบบ":"Trade Registration","ประเภทการแจ้ง":"Issue / Bug","ความรุนแรงของปัญหา":"Major","Menu / Flow ที่ต้องการปรับปรุง":"","รายละเอียดที่ต้องการ":"Cannot read properties of undefined (reading 'replace)","Note":"","Assign":"BU3","Due date":"03/11/2025","ขอภาพประกอบ / ไฟล์ประกอบ (ถ้ามี)":"","Url / Link ที่ใช้งาน (ถ้ามี)":"","Respondents":"","Submitted on":"2025/11/05 11:15","Submitted Reject":"","Submitted Dev Done":"","Submitted Completed":"","QA":"","Impact Analytic":"","Version":"","SOW_FuncNo":"","ชื่อผู้แจ้งเคส":"","อีเมลติดต่อกลับ":"","เบอร์ติดต่อกลับ":"","Sprint":"","Satatus Text":"Dev Done","Week":"45","Time":"11","Working Hours":"Normal Time","Month":"11","Formula":"Network / Error Message","Develop By":"","Fixbug":"","Remark":"","LastWeek":"45","Year":"2025","SubmittedOn_ISO":"2025-11-05T11:15:00.000-05:00","Type":"Request-DITP"}];
const RequestProgressStatus = [{"name":"Completed","value":15},{"name":"Cancel","value":1},{"name":"Dev Done","value":9},{"name":"Normal Time","value":7},{"name":"Todo","value":1},{"name":"On Process","value":2}];
const RequestAllSeverity = [{"name":"Request-EMT","critical":0,"major":5,"medium":0,"minor":2,"comment":0,"total":7},{"name":"Request-EVC","critical":0,"major":5,"medium":0,"minor":2,"comment":0,"total":7},{"name":"Request-CPOT","critical":0,"major":2,"medium":1,"minor":1,"comment":3,"total":7},{"name":"Request-EVPT","critical":0,"major":4,"medium":0,"minor":3,"comment":0,"total":7},{"name":"Request-DITP","critical":0,"major":2,"medium":2,"minor":3,"comment":0,"total":7}];


// ✅ ข้อมูลเฉพาะ LastWeek
const summaryProjectLast = [{"name":"CPOT","task":0,"bugs":3,"total":3,"bugRate":"100.0%"},{"name":"DITP Website","task":0,"bugs":3,"total":3,"bugRate":"100.0%"},{"name":"ExpoInfo 2025","task":3,"bugs":0,"total":3,"bugRate":"0.0%"},{"name":"NCC","task":0,"bugs":3,"total":3,"bugRate":"100.0%"},{"name":"Test Project One","task":12,"bugs":1,"total":13,"bugRate":"7.7%"},{"name":"Test Project Two","task":9,"bugs":3,"total":12,"bugRate":"25.0%"}];
const summaryPlatformLast = [{"name":"EMT","task":0,"bugs":5,"total":5,"bugRate":"100.0%"},{"name":"EventConnex Lite","task":5,"bugs":0,"total":5,"bugRate":"0.0%"},{"name":"Test Platform One","task":9,"bugs":3,"total":12,"bugRate":"25.0%"},{"name":"Test Platform Two","task":12,"bugs":1,"total":13,"bugRate":"7.7%"}];
const progressProjectTLast = [{"name":"QA Done","value":12},{"name":"Dev Done","value":3},{"name":"To Do","value":3},{"name":"In Progress","value":2}];
const progressPlatformTLast = [{"name":"To Do","value":7},{"name":"Dev Done","value":2},{"name":"In Progress","value":2},{"name":"QA Done","value":10}];
const progressProjectBLast = [{"name":"QA Done","value":7},{"name":"Dev Done","value":2},{"name":"Fix bug","value":4}];
const progressPlatformBLast = [{"name":"To Do","value":1},{"name":"QA Done","value":4},{"name":"Fix bug","value":4}];

// ✅ ฟังก์ชันแสดงตาราง
function fillSummaryTable(id, data) {
  const el = document.getElementById(id);
  if (!el) return;
  el.innerHTML = "";
  let totalTask = 0, totalBugs = 0, totalAll = 0;
  grandTotal = data.reduce((sum, r) => sum + r.total, 0);
  data.forEach(d=>{
    const percentOfGrand = grandTotal > 0
      ? ((d.total / grandTotal) * 100).toFixed(1) + "%"
      : "0%";
    el.insertAdjacentHTML('beforeend',`
      <tr>
        <td>${d.name}</td>
        <td>${d.task}</td>
        <td>${d.bugs}</td>
        <td>${d.total}<span style="color:#777">(${percentOfGrand})</span></td>
        <td>${d.bugRate}</td>
      </tr>
      `);
    totalTask += d.task;
    totalBugs += d.bugs;
    totalAll += d.total;
  });
    // คำนวณรวมทั้งหมด (รวม rate ด้วย)
  const totalBugRate = totalTask > 0 ? ((totalBugs / totalTask) * 100).toFixed(1) : "0";
  el.insertAdjacentHTML('beforeend',`
    <tr><td><b>Total</b></td><td>${totalTask}</td><td>${totalBugs}</td><td>${totalAll}</td><td><b>${totalBugRate}%</b></td></tr>
  `);
}

// ✅ ฟังก์ชันแสดงตาราง Task Remaining
function RemainingSummaryTable(id, data) {
  const el = document.getElementById(id);
  if (!el) return;

  el.innerHTML = "";
  let total = 0;

  data.forEach(d => {
    const value = d.task ?? d.bug ?? d.total ?? 0;  // ✅ รองรับทั้ง task และ bug
    el.insertAdjacentHTML('beforeend', `
      <tr>
        <td>${d.name}</td>
        <td>${value}</td>
      </tr>
    `);
    total += value;
  });

  el.insertAdjacentHTML('beforeend', `
    <tr>
      <td><b>Total</b></td>
      <td><b>${total}</b></td>
    </tr>
  `);
}

function RequestTypeSummaryTable(id, rows) {
  const el = document.getElementById(id);
  if (!el) return;

  // ✅ รวบรวมชื่อประเภทการแจ้งทั้งหมด
  const allTypes = [...new Set(rows.map(r =>
    (safe(r["Type of request"]) || safe(r["ประเภทการแจ้ง"]) || "").trim()
  ))].filter(Boolean);

  // ✅ แยกระบบ เช่น request-emt → EMT
  const grouped = {};
  rows.forEach(r => {
    const type = String(safe(r.Type)).trim().toLowerCase();
    if (!type.startsWith("request-")) return;

    const from = type.replace("request-", "").toUpperCase();
    const reqType = (safe(r["Type of request"]) || safe(r["ประเภทการแจ้ง"]) || "").trim();
    if (!reqType) return;

    if (!grouped[from]) grouped[from] = {};
    grouped[from][reqType] = (grouped[from][reqType] || 0) + 1;
  });

  el.innerHTML = "";

  // ✅ สร้างหัวตาราง
  const header = `
    <tr>
      <th>Request From</th>
      ${allTypes.map(t => `<th>${t}</th>`).join("")}
      <th>Total</th>
    </tr>`;
  el.insertAdjacentHTML("beforeend", header);

  // ✅ สร้างแถวข้อมูลแต่ละระบบ
  Object.entries(grouped).forEach(([from, typeCount]) => {
    const total = Object.values(typeCount).reduce((a, b) => a + b, 0);
    const row = `
      <tr>
        <td><b>${from}</b></td>
        ${allTypes.map(t => `<td>${typeCount[t] || 0}</td>`).join("")}
        <td><b>${total}</b></td>
      </tr>`;
    el.insertAdjacentHTML("beforeend", row);
  });

  // ✅ แถวรวมทั้งหมด
  const totals = {};
  Object.values(grouped).forEach(typeCount => {
    for (const t of allTypes) totals[t] = (totals[t] || 0) + (typeCount[t] || 0);
  });
  const grandTotal = Object.values(totals).reduce((a, b) => a + b, 0);

  const footer = `
    <tr>
      <td><b>Total</b></td>
      ${allTypes.map(t => `<td><b>${totals[t] || 0}</b></td>`).join("")}
      <td><b>${grandTotal}</b></td>
    </tr>`;
  el.insertAdjacentHTML("beforeend", footer);
}



// ✅ ฟังก์ชัน Line Chart
function lineChart(id, data, color, label) {
  const el = document.getElementById(id);
  if (!el) return;
  const ctx = el.getContext('2d');

  // 🎨 gradient background
  const gradient = ctx.createLinearGradient(0, 0, 0, 160);
  gradient.addColorStop(0, color + 'aa');
  gradient.addColorStop(0.5, color + '66');
  gradient.addColorStop(1, color + '11');

  // ✅ สร้างกราฟ
  const chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: data.map(d => d.key),
      datasets: [{
        label,
        data: data.map(d => d.value),
        borderColor: color,
        backgroundColor: gradient,
        fill: true,
        tension: 0.4,
        borderWidth: 3,
        pointBackgroundColor: '#ffffff',
        pointBorderColor: color,
        pointBorderWidth: 3,
        pointRadius: 5,
        pointHoverRadius: 7,
        pointHoverBackgroundColor: color,
        pointHoverBorderColor: '#ffffff',
        pointHoverBorderWidth: 3
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          labels: {
            color: '#8b3a00',
            font: { size: 12, weight: '600' },
            padding: 10
          }
        },
        tooltip: {
          enabled: true
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          grid: { color: 'rgba(255,180,60,0.1)' },
          ticks: { color: '#8b3a00' }
        },
        x: {
          grid: { color: 'rgba(255,180,60,0.1)' },
          ticks: { color: '#8b3a00' }
        }
      }
    },
    // ✅ ใช้ plugin ภายในเพื่อวาดตัวเลข (Chart.js v4 compatible)
    plugins: [{
      id: 'valueLabels',
      afterDatasetsDraw(chart) {
        const { ctx } = chart;
        ctx.save();
        ctx.font = 'bold 11px sans-serif';
        ctx.fillStyle = '#8b3a00';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'bottom';

        chart.data.datasets.forEach((dataset, i) => {
          const meta = chart.getDatasetMeta(i);
          meta.data.forEach((point, index) => {
            const value = dataset.data[index];
            if (value !== null && value !== undefined) {
              ctx.fillText(value, point.x, point.y - 8); // แสดงเลขเหนือจุด
            }
          });
        });
        ctx.restore();
      }
    }]
  });
}



// ✅ ฟังก์ชัน Pie Chart
function pieChart(id, data) {
  const el = document.getElementById(id);
  if (!el || !data?.length) return;
  const ctx = el.getContext('2d');

  const colors = [
    "#FFD93D", "#1fa371", "#FF8C42", "#FF6B35",
    "#E63946", "#D62828", "#FBBF24", "#F97316"
  ];

  // 🧩 คำนวณ total สำหรับแสดงเปอร์เซ็นต์
  const total = data.reduce((sum, d) => sum + d.value, 0);

  new Chart(ctx, {
    type: 'pie',
    data: {
      labels: data.map(d => d.name),
      datasets: [{
        data: data.map(d => d.value),
        backgroundColor: colors,
        borderWidth: 1,
        borderColor: '#ffffff',
        hoverOffset: 5,
        hoverBorderWidth: 3,
        hoverBorderColor: '#ffffff',
        padding: 15,

      }]
    },
    options: {
    maintainAspectRatio: false,
    radius: "70%",
  layout: {
    padding: 10  // ปรับพื้นที่รอบวง
  },
      plugins: {
        legend: {
          position: 'bottom',
          labels: {
            padding: 30,
            font: { size: 12, weight: '200' },
            color: '#8b3a00',
            usePointStyle: true,
            pointStyle: 'circle'
          }
        },
        tooltip: {
          backgroundColor: 'rgba(139, 58, 0, 0.9)',
          titleColor: '#ffffff',
          bodyColor: '#ffffff',
          borderColor: '#FFB347',
          borderWidth: 2,
          padding: 12,
          displayColors: true,
          boxPadding: 6,
          callbacks: {
            label: function (context) {
              const value = context.parsed;
              const percent = ((value / total) * 100).toFixed(1) + '%';
              return `${context.label}: ${value} (${percent})`;
            }
          }
        }
      }
    },
plugins: [{
  id: "pieLabelCallout",
  afterDatasetsDraw(chart) {
    const ctx = chart.ctx;
    const meta = chart.getDatasetMeta(0);
    const dataset = chart.data.datasets[0];
    const total = dataset.data.reduce((a, b) => a + b, 0);

    // ✅ ใช้ตำแหน่งจริงของ Pie Chart
    const arc = meta.data[0];
    const centerX = arc.x;
    const centerY = arc.y;
    const radius = arc.outerRadius;

    const labels = [];

    meta.data.forEach((slice, i) => {
      const value = dataset.data[i];
      if (!value) return;

      const labelName = chart.data.labels[i] || "";
      const percent = ((value / total) * 100).toFixed(1);
      const labelText = `${labelName} — ${value} (${percent}%)`;

      const angle = (slice.startAngle + slice.endAngle) / 2;
      const x = Math.cos(angle);
      const y = Math.sin(angle);

      const lineStartX = centerX + x * radius;
      const lineStartY = centerY + y * radius;

      const bendX = centerX + x * (radius + 25);
      const bendY = centerY + y * (radius + 25);

      const isRight = x >= 0;
      const endX = bendX + (isRight ? 50 : -50);

      ctx.font = "bold 12px Arial";
      const textWidth = ctx.measureText(labelText).width;

      labels.push({
        isRight,
        labelText,
        textWidth,
        lineStartX,
        lineStartY,
        bendX,
        bendY,
        endX,
        endY: bendY,
        height: 18
      });
    });

    // 🔧 ป้องกันชนกันด้วย spacing
    const left = labels.filter(l => !l.isRight).sort((a,b)=>a.endY - b.endY);
    const right = labels.filter(l => l.isRight).sort((a,b)=>a.endY - b.endY);

    const adjustSpacing = (arr) => {
      const space = 22;
      for (let i = 1; i < arr.length; i++) {
        if (arr[i].endY - arr[i - 1].endY < space) {
          arr[i].endY = arr[i - 1].endY + space;
        }
      }
    };

    adjustSpacing(left);
    adjustSpacing(right);

    // 🎨 วาดทั้งหมด
    labels.forEach(L => {
      ctx.save();

      ctx.strokeStyle = "#555";
      ctx.lineWidth = 1.4;
      ctx.beginPath();
      ctx.moveTo(L.lineStartX, L.lineStartY);
      ctx.lineTo(L.bendX, L.bendY);
      ctx.lineTo(L.endX, L.endY);
      ctx.stroke();

      ctx.beginPath();
      ctx.arc(L.lineStartX, L.lineStartY, 3, 0, Math.PI * 2);
      ctx.fillStyle = "#555";
      ctx.fill();

      const padding = 6;
      const boxWidth = L.textWidth + padding * 2;
      const boxHeight = L.height;
      const boxX = L.isRight ? L.endX : L.endX - boxWidth;
      const boxY = L.endY - boxHeight / 2;

      ctx.fillStyle = "rgba(255,255,255,0.95)";
      ctx.strokeStyle = "#ddd";
      ctx.beginPath();
      ctx.roundRect(boxX, boxY, boxWidth, boxHeight, 4);
      ctx.fill();
      ctx.stroke();

      ctx.fillStyle = "#222";
      ctx.font = "bold 12px Arial";
      ctx.textAlign = L.isRight ? "left" : "right";
      ctx.fillText(
        L.labelText,
        L.isRight ? (boxX + padding) : (boxX + boxWidth - padding),
        L.endY
      );

      ctx.restore();
    });
  }
}]


  });
}



function BugSeverityTable(id, data) {
  const el = document.getElementById(id);
  if (!el) return;

  el.innerHTML = "";
  let totals = { critical: 0, major: 0, medium: 0, minor: 0, comment: 0, total: 0 };

  data.forEach(d => {
    el.insertAdjacentHTML("beforeend", `
      <tr>
        <td>${d.name}</td>
        <td>${d.critical}</td>
        <td>${d.major}</td>
        <td>${d.medium}</td>
        <td>${d.minor}</td>
        <td>${d.comment}</td>
        <td>${d.total}</td>
      </tr>
    `);

    totals.critical += d.critical;
    totals.medium += d.medium;
    totals.major += d.major;
    totals.minor += d.minor;
    totals.comment += d.comment;
    totals.total += d.total;
  });

  // ✅ แสดงแถวรวม
  el.insertAdjacentHTML("beforeend", `
    <tr style="background-color:#fff0d9;font-weight:bold;color:#8b3a00;">
      <td>Total</td>
      <td>${totals.critical}</td>
      <td>${totals.major}</td>
      <td>${totals.medium}</td>
      <td>${totals.minor}</td>
      <td>${totals.comment}</td>
      <td>${totals.total}</td>
    </tr>
 `);
}

function safe(v) {
  return (v ?? "").toString().trim();
}

function RequestPivotSummaryTable(id, rows) {
  const el = document.getElementById(id);
  if (!el) {
    console.error(`❌ Element with id="${id}" not found`);
    return;
  }

  if (!Array.isArray(rows) || rows.length === 0) {
    el.innerHTML = "<p style='text-align:center;color:gray;'>No data available</p>";
    return;
  }

  // 🧩 ดึงชื่อคอลัมน์ทั้งหมด (ประเภทการแจ้ง)
  const allTypes = [...new Set(
    rows.map(r => safe(r["Type of request"]) || safe(r["ประเภทการแจ้ง"]))
  )].filter(Boolean);

  // 🧩 ดึงชื่อ Request From ทั้งหมด เช่น Request-EMT, Request-EVC
  const allRequests = [...new Set(rows.map(r => safe(r.Type)))].filter(Boolean);

  // 🧮 สร้าง Map นับจำนวน
  const map = {};
  for (const r of rows) {
    const reqFrom = safe(r.Type);
    const reqType = safe(r["Type of request"]) || safe(r["ประเภทการแจ้ง"]);
    if (!reqFrom || !reqType) continue;

    if (!map[reqFrom]) map[reqFrom] = {};
    if (!map[reqFrom][reqType]) map[reqFrom][reqType] = 0;
    map[reqFrom][reqType]++;
  }

  // 🧱 สร้าง HTML
  let html = `
    <table border="1" style="border-collapse:collapse;width:100%;text-align:center;">
      <thead style="background:#eaeaea;">
        <tr>
          <th>Request From</th>
          ${allTypes.map(t => `<th>${t}</th>`).join("")}
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
  `;

  // 🧩 แถวแต่ละ Request
  allRequests.forEach(req => {
    const counts = allTypes.map(t => map[req]?.[t] || 0);
    const total = counts.reduce((a, b) => a + b, 0);
    html += `
      <tr>
        <td>${req}</td>
        ${counts.map(c => `<td>${c}</td>`).join("")}
        <td><b>${total}</b></td>
      </tr>
    `;
  });

  // ✅ แถวรวมทั้งหมด
  const totalByType = allTypes.map(t =>
    allRequests.reduce((sum, req) => sum + (map[req]?.[t] || 0), 0)
  );
  const grandTotal = totalByType.reduce((a, b) => a + b, 0);

  html += `
      <tr style="background:#f3f3f3;font-weight:bold;">
        <td>Total</td>
        ${totalByType.map(t => `<td>${t}</td>`).join("")}
        <td>${grandTotal}</td>
      </tr>
    </tbody>
  </table>
  `;

  el.innerHTML = html;
}


// ✅ เรียกใช้งานจริง
fillSummaryTable("summaryProjectLast", summaryProjectLast);
fillSummaryTable("summaryPlatformLast", summaryPlatformLast);
RemainingSummaryTable("taskRemainingProject", FilterProjectLatestWeek);
RemainingSummaryTable("taskRemainingPlatform", FilterPlatformLatestWeek);
RemainingSummaryTable("bugRemainingProject", 
  FilterProjectBugLatestWeek.map(d => ({ name: d.name, task: d.bug }))
);
RemainingSummaryTable("bugRemainingPlatform", 
  FilterPlatformBugLatestWeek.map(d => ({ name: d.name, task: d.bug }))
);
fillSummaryTable("bugProjectTable", summaryProjectLast);
fillSummaryTable("bugPlatformTable", summaryPlatformLast);
BugSeverityTable("bugSeverityProject", bugSeverityProject);
BugSeverityTable("bugSeverityPlatform", bugSeverityPlatform);
BugSeverityTable("levelFormRequest",RequestAllSeverity)

// ✅ แสดงกราฟเส้น - Monthly = ส้ม, Weekly = เขียว
lineChart("chartProjectMonthly", taskMonthlyProject, "#FF8C42", "Project Monthly");
lineChart("chartProjectWeekly", taskWeeklyProject, "#10B981", "Project Weekly");
lineChart("chartPlatformMonthly", taskMonthlyPlatform, "#FF8C42", "Platform Monthly");
lineChart("chartPlatformWeekly", taskWeeklyPlatform, "#10B981", "Platform Weekly");
lineChart("bugProjectMonthly", bugMonthlyProject, "#FF8C42", "Monthly Bugs");
lineChart("bugProjectWeekly", bugWeeklyProject, "#10B981", "Weekly Bugs");
lineChart("bugPlatformMonthly", bugMonthlyPlatform, "#FF8C42", "Monthly Bugs");
lineChart("bugPlatformWeekly", bugWeeklyPlatform, "#10B981", "Weekly Bugs");
lineChart("chartRequestWeekly", requestWeeklyAll, "#1fa371", "Request Weekly");
lineChart("chartRequestMonthly", requestMonthlyAll, "#ff8c42", "Request Monthly");

// ✅ แสดงกราฟ Pie
pieChart("pieProject", progressProjectTLast);
pieChart("piePlatform", progressPlatformTLast);
pieChart("bugPieProject", progressProjectBLast);
pieChart("bugPiePlatform", progressPlatformBLast);
pieChart("pieRequestStatus", RequestProgressStatus);


RequestPivotSummaryTable("RequestAll", RequestAllLatestWeek);
</script>
</body>
</html>

